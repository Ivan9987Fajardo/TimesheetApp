
<div class="container" style="text-align: center;">
    <img src="../../Timesheet/assets/teralogo.png" alt="TeraSystem" width="300px" style="margin:10px;">
</div>

<div class="container" [formGroup]="group" style="background-color:  #5A5A5A; padding: 5px; border-radius: 10px; color: white;">
    <div class="row">
        <a href="#" onclick="return false;" (click)="headerButtonToggle()" style="margin-left: 10px; color: white;">
            <svg class="bi bi-chevron-down" width="25" height="25" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6.646 3.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L12.293 10 6.646 4.354a.5.5 0 010-.708z" clip-rule="evenodd"/></svg>

        </a>
        <h5>Employee Information</h5>
    </div>
    <div class="row">
        <ng-container *ngIf ="headerToggle">
            <div class="col-sm-6" >
                <div class="row">
                    <div class="col-sm-4">
                        Employee No.
                    </div>
                    <div class="col-sm-6 inputHeader">
                        <input type="number" class="form-control form-control-sm" name="empNo" id="empNo" formControlName="empNo">
                    </div>
                </div>
            
                <div class="row">
                    <div class="col-sm-4">
                        Employee Name
                    </div>
                    <div class="col-sm-6 inputHeader">
                        <input type="text" class="form-control form-control-sm" name="empName" id="empName" formControlName="empName">
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-4">
                        Employee Supervisor
                    </div>
                    <div class="col-sm-6 inputHeader">
                        <input type="text" class="form-control form-control-sm" name="empSupervisor" id="empSupervisor" formControlName="empSupervisor">
                    </div>
                </div>
            </div>
        
            <div class="col-sm-6" style="text-align: right;">
                <div class="row">
                    <div class="col-sm-4">
                        Supervisor & Employee Initials
                    </div>
                    <div class="col-sm-6 inputHeader">
                        <input type="text" class="form-control form-control-sm" name="empInitials" id="empInitials" formControlName="empInitials" placeholder="Sprvsr and Emp Initial ex. 'FEAJAF'">
                    </div>
                </div>
            
                <div class="row">
                    <div class="col-sm-4">
                        Group
                    </div>
                    <div class="col-sm-6 inputHeader" >
                        <input list="empGroup" name="empGroup" class="form-control form-control-sm" formControlName="group">
                        <datalist id="empGroup">
                            <ng-container *ngFor="let group of empGroup; let i = index" >
                                <option value={{group}}></option>
                            </ng-container>
                        </datalist>
                    </div>
                </div>
                

            </div>
    

        </ng-container>
        
    </div>
</div>

<div class="container" [formGroup]="group" style="margin-top: 5px; background-color: #5a5a5a; padding: 5px; border-radius: 10px;">
    <div class="row text-white">
        <a href="#" onclick="return false;" (click)="tableButtonToggle()" style="margin-left: 10px; color: white;">
            <svg class="bi bi-chevron-down" width="25" height="25" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6.646 3.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L12.293 10 6.646 4.354a.5.5 0 010-.708z" clip-rule="evenodd"/></svg>

        </a>
        <h5>Time In/Out</h5>
    </div>

    <ng-container *ngIf = "tableToggle">
        <div class="row text-white" style="padding: 5px;">
            <div class="col-sm-3">
                <div class="row">
                    <label class="col-sm-3">From: </label>
                    <input type="date" class="form-control form-control-sm col-sm-9" formControlName="dateFrom" disabled style="width: 150px;;"> 

                </div>
                
            </div>

            <div class="col-sm-3">
                <div class="row">
                    <label class="col-sm-3">To: </label>
                    <input type="date" class="form-control form-control-sm col-sm-9" formControlName="dateTo" (change)="setDate()" style="width: 150px;;">
                    
                </div>                
            </div>

            <div class="col-sm-6">
                <div class="row" >
                    <div class="col-sm-8"></div>
                    <div class="col-sm-4">
                        <button class="btn btn-sm" (click)=timeIn() style="background-color: #d4d4d4;">Time In</button> &nbsp;
                        <button class="btn btn-sm" (click)=timeOut() style="background-color: #d4d4d4;">Time Out</button>
                    </div>
                        
                    
                </div>                
            </div>
            <div class="col-sm-6"></div>
        </div>

        <table class="table table-sm text-white">
            <thead>
                <th></th>
                <th>Saturday</th>
                <th>Sunday</th>
                <th>Monday</th>
                <th>Tuesday</th>
                <th>Wednesday</th>
                <th>Thursday</th>
                <th>Friday</th>
            </thead>
            <tbody>
                <ng-container formArrayName="timeInOut">               
                        <tr>
                            <td>Time In</td>
                            <ng-container *ngFor="let number of timeInOut.controls; let i = index" > 
                                <td [formGroupName]="i">
                                    <input type="time" class="form-control form-control-sm" formControlName="timeIn" (change)="getHoursPerDay()">
                                </td>
                        
                            </ng-container>
                        </tr>

                        <tr>
                            <td>TimeOut</td>
                            <ng-container *ngFor="let number of timeInOut.controls; let i = index" > 
                                <td [formGroupName]="i">
                                    <input type="time" class="form-control form-control-sm" formControlName="timeOut" (change)="getHoursPerDay()">
                                </td>
                        
                            </ng-container>
                        </tr>

                        <tr>
                            <td>Total Hours</td>
                            <ng-container *ngFor="let number of timeInOut.controls; let i = index" > 
                                <td [formGroupName]="i">
                                    <input type="number" class="form-control form-control-sm" formControlName="hours" disabled >
                                </td>
                        
                            </ng-container>
                        </tr>
                    

                </ng-container>
                
            </tbody>
        </table>
        
    </ng-container>
    
</div>

<div class="container" [formGroup]="group" style="margin-bottom: 5%; margin-top: 10px;">

    <button class="btn btn-sm text-white" (click)="newRow()" style="background-color:#474747;">Add new task</button>&nbsp;
    <button class="btn btn-sm text-white" (click)="newOthersRow()" style="background-color: #777777;">Add new Other</button>
    
    <table class="table table-bordered table-sm" style="margin-top: 5px;">
        <thead style="text-align: center;">
            <th class="text-white" style="background-color:#474747;"></th>
            <th class="text-white" style="width: 150px; background-color:#474747;">Client Name</th>
            <th class="text-white" style="width: 180px; background-color:#474747;">Project Name</th>
            <th class="text-white" style="width: 150px; background-color:#474747;">Task</th>
            <th class="text-white" style="width: 300px; background-color:#474747;">Activities</th>
            <th class="bg-secondary text-white" style="width: 80px;">Sat</th>
            <th class="bg-secondary text-white" style="width: 80px;">Sun</th>
            <th class="bg-secondary text-white" style="width: 80px;">Mon</th>
            <th class="bg-secondary text-white" style="width: 80px;">Tue</th>
            <th class="bg-secondary text-white" style="width: 80px;">Wed</th>
            <th class="bg-secondary text-white" style="width: 80px;">Thu</th>
            <th class="bg-secondary text-white" style="width: 80px;">Fri</th>
            <th class="text-white" style="background-color: #303030;">Total</th>
        </thead>
        <tbody>
            <ng-container formArrayName="timeSheet">
                <ng-container *ngFor="let number of timeSheet.controls; let i = index" > 
                    <tr [formGroupName]="i">
                        <td>
                            <button class="btn btn-danger btn-sm" (click)="deleteRow(i)">X</button>
                        </td>
                        
                        <td>
                            <input list="clientName" name="clientName" class="form-control form-control-sm" formControlName="cName">
                            <datalist id="clientName" >
                                <ng-container *ngFor="let client of cName; let i = index" >
                                    <option value={{client}}></option>
                                </ng-container>
                            </datalist>
                        </td>
        
                        <td>
                            <input list="projName" name="projName"  class="form-control form-control-sm" formControlName="pName">
                            <datalist id="projName">
                                <ng-container *ngFor="let project of pName; let i = index">
                                    <option value={{project}}></option>
                                </ng-container>
                            </datalist>
                        </td>
        
                        <td>
                            <input list="task" name="task" class="form-control form-control-sm" formControlName="task">
                            <datalist id="task">
                                <ng-container *ngFor="let task of tasks; let i = index">
                                    <option value={{task}}></option>
                                </ng-container>
                            </datalist>
                        </td>
        
                        <td>
                            <input type="text" formControlName="activity" class="form-control form-control-sm">
                        </td>
                        
                        <ng-container *ngFor="let day of days">
                            <td>
                                <input type="number"  formControlName={{day}} class="form-control form-control-sm" (change)="validateInput(i,day,'timeSheet')">
                            </td>
                        </ng-container>
                        
                        
                        <td class="table-success">
                            {{ rowArray[i] }}
                        </td>
                        
                    </tr>
                </ng-container>
            </ng-container>
            
            <tr>
                <td colspan="4"></td>
                <td style="text-align: right;"><strong>Total Work Hours:</strong></td>
                <ng-container *ngFor="let day of days">
                    <td class="table-warning">{{colArray[day]}}</td>
                </ng-container>
                <td class="bg-warning">{{ totalRowCol }}</td>

            </tr>

            <tr style="text-align: center;">
                <th colspan="2" class="text-white" style="background-color: #777777;"></th>
                <th class="text-white" style="background-color: #777777;">Type</th>
                <th class="text-white" style="background-color: #777777;">Activity</th>
                <th class="text-white" style="background-color: #777777;">Description</th>
                <th colspan="8"></th>                
            </tr>

            <ng-container formArrayName="others">
                <ng-container *ngFor="let other of others.controls; let i = index" > 
                    <tr [formGroupName]="i">
                        <td colspan="2">
                            <button class="btn btn-danger btn-sm" (click)="deleteOthersRow(i)">X</button>
                        </td>
                        <td>
                            <input list="type" name="type" class="form-control form-control-sm" formControlName="type">
                            <datalist id="type">
                                <ng-container *ngFor="let type of othersType; let i = index">
                                    <option value={{type}}></option>
                                </ng-container>
                            </datalist>
                        </td>

                        <td>
                            <input list="activity" name="activity" class="form-control form-control-sm" formControlName="activity">
                            <datalist id="activity">
                                <ng-container *ngFor="let act of othersActivity; let i = index">
                                    <option value={{act}}></option>
                                </ng-container>
                            </datalist>
                        </td>

                        <td>
                            <input type="text" class="form-control form-control-sm" formControlName="description">
                        </td>

                        <ng-container *ngFor="let day of days">
                            <td>
                                <input type="number" formControlName={{day}} class="form-control form-control-sm" (change)="validateInput(i,day,'others')">
                            </td>
                        </ng-container>
                        <td class="table-success">
                            {{ othersRowArray[i] }}
                        </td>
                    </tr>
                </ng-container>
            </ng-container>
            <tr>
                <td colspan="4"></td>
                <td style="text-align: right;"><strong>Total Non-Work Hours:</strong></td>
                <ng-container *ngFor="let day of days">
                    <td class="table-warning">{{othersColArray[day]}}</td>
                </ng-container>
                <td class="bg-warning">{{ othersTotalRowCol }}</td>

            </tr>

            <tr>
                <td colspan="4"></td>
                <td style="text-align: right;"><strong>Total Hours:</strong></td>
                <ng-container *ngFor="let day of days; let i = index">
                    <ng-container *ngIf="timeInOut.controls[i].get('hours').valid">
                        <td class="bg-success">{{finalRow[day]}}</td>
                    </ng-container>
                    <ng-container *ngIf="timeInOut.controls[i].get('hours').invalid">
                        <td class="bg-danger">{{finalRow[day]}}</td>
                    </ng-container>

                </ng-container>
                <td class="bg-primary">{{ finalTotal }}</td>

            </tr>
            <tr *ngIf="timeInOut.invalid">
                <td colspan="5"></td>
                <td colspan="8" class="text-danger">*Total Hours must be the same in the Time In/Out table.</td>
            </tr>

        </tbody>
    </table>
        <button class="btn btn-primary btn-sm" style="float: right;" (click)="generate()">Download </button>
        <!-- <button class="btn btn-success btn-sm" style="float: right; margin-right: 10px;"  (click)="setToLocal()">Save As Draft</button> -->
        <button class="btn btn-primary btn-sm" style="float: left;" (click)="toggleWFH()" style="margin: 5px;">Generate WFH</button>
        <button class="btn btn-primary btn-sm" style="float: left;" (click)="toggleEmail()" style="margin: 5px;">Send Email</button>

</div>

<ng-container *ngIf=showWFH>
    <div class="modal2" [formGroup]="group">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title">WFH Task Accomplishments</h5>
          <button type="button" class="close" (click)="toggleWFH()">&times;</button>
        </div>
  
        <!-- Modal body -->
        <div class="modal-body">
            <div class="row">

                    <div class="col-sm-1">Day:</div>
                    <div class="col-sm-2">
                        <select class="form-control form-control-sm" formControlName="wfh">
                            <ng-container *ngFor="let day of days; let i = index">
                                <option value="{{i}}">{{day| titlecase}}</option>
                            </ng-container>
                            
                        </select>
                    </div>

            </div>
            <div class="row">

                <div class="col-sm-1">Date:</div>
                <div class="col-sm-2">
                    {{ dateArray[group.get('wfh').value] }}
                </div>

            </div>
            <br><br>
            <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Hi Sir!</p>
            <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Please see work from home details for {{ dateArray[group.get('wfh').value] }} ({{days[group.get('wfh').value]| titlecase}}):</p>
            <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Attendance Detail:</p>
            <table border="1" cellspacing="0" cellpadding="0" align="left" style="border-collapse:collapse;border:none;margin-left:6.75pt;margin-right:6.75pt"><tbody><tr style="height:17.1pt"><td width="103" valign="top" style="width:77.3pt;border:1pt solid windowtext;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>LOG IN</b></p></td><td width="103" valign="top" style="width:77.3pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>LOG OUT</b></p></td></tr><tr style="height:17.1pt"><td width="103" valign="top" style="width:77.3pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                {{  
                (group.get('timeInOut')['controls'][group.get('wfh').value].get('timeIn').value!==null)?('2000-01-01T'+group.get('timeInOut')['controls'][group.get('wfh').value].get('timeIn').value | date:'shortTime':'undefined':'en-US'):''}}</p></td><td width="103" valign="top" style="width:77.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    
                {{ 
                (group.get('timeInOut')['controls'][group.get('wfh').value].get('timeOut').value!==null)?('2000-01-01T'+group.get('timeInOut')['controls'][group.get('wfh').value].get('timeOut').value | date:'shortTime':'undefined':'en-US'):''}}</p></td></tr></tbody></table>
            <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
            <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
            <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
            <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Task Accomplishment Summary for the day</p>

            <table border="0" cellspacing="0" cellpadding="0" width="601" style="width:450.8pt;border-collapse:collapse">
                <tbody>
                   <tr>
                      <td width="200" valign="top" style="width:150.25pt;border:1pt solid windowtext;padding:0cm 5.4pt">
                         <p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>TASK</b></p>
                      </td>
                      <td width="200" valign="top" style="width:150.25pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0cm 5.4pt">
                         <p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>STATUS</b></p>
                      </td>
                      <td width="200" valign="top" style="width:150.3pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0cm 5.4pt">
                         <p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>REMARKS</b></p>
                      </td>
                   </tr>
                   <tr *ngIf="wfhTasks.length === 0">
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                        <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">No task for the day</p>
                     </td>
                     <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                     <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                  
                    </tr>
                   <ng-container *ngFor="let task of wfhArray; let i = index">
                    <tr>
                        <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                           <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">{{wfhTasks[i]}}</p>
                        </td>
                        <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                        
                        <ng-container *ngIf="showEditWFH">
                            <input class="form-control form-control-sm" list=wfhStatus [(ngModel)]="wfhArray[i]['status']" [ngModelOptions]="{standalone: true}">
                            <datalist id=wfhStatus>
                                <option value="Completed"></option>
                                <option value="Ongoing"></option>
                                
                            </datalist>
                        </ng-container>
                        <ng-container *ngIf="!showEditWFH">
                            {{wfhArray[i]['status']}}
                        </ng-container>
                        
                        </td>
                        <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                            <ng-container *ngIf="showEditWFH">
                                <input class="form-control form-control-sm" [(ngModel)]="wfhArray[i]['remarks']" [ngModelOptions]="{standalone: true}">
                            </ng-container>
                            <ng-container *ngIf="!showEditWFH">
                                {{wfhArray[i]['remarks']}}
                            </ng-container>
                            
                        </td>
                     </tr>
                   </ng-container>
                   <tr>
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                        &nbsp;
                       </p>
                    </td>
                    <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                    <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                 </tr>
                 <tr>
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                        &nbsp;
                       </p>
                    </td>
                    <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                    <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                 </tr>
                    
                   
                   <tr>
                      <td width="601" colspan="3" valign="top" style="width:450.8pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                         <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>Other tasks on Queue:</b></p>
                      </td>
                   </tr>
                   <tr *ngIf="wfhQueue.length === 0">
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                        <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">No pending task</p>
                     </td>
                     <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                     <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                  
                    </tr>
                   <ng-container *ngFor="let task of wfhQueue">
                    <tr>
                        <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                           <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">{{task}}</p>
                        </td>
                        <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                        </td>
                        <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                     </tr>
                   </ng-container>
                   <tr>
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                        &nbsp;
                       </p>
                    </td>
                    <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                    <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                 </tr>
                 <tr>
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                        &nbsp;
                       </p>
                    </td>
                    <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                    <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                    </td>
                 </tr>
                   
                   
                </tbody>
             </table>

           
            
        </div>
  
        <!-- Modal footer -->
        <div class="modal-footer">
            <ng-container *ngIf=showEditWFH>
                <button type="button" class="btn btn-success" (click)="toggleEditWFH()">Done</button>
            </ng-container>
            <ng-container *ngIf=!showEditWFH>
                <button type="button" class="btn btn-primary" (click)="toggleEditWFH()">Edit</button>
            </ng-container>
          
        </div>
  
      </div>
    </div>

</ng-container>

<ng-container *ngIf=showEmail>
    <div class="modal2" [formGroup]="emailGroup">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title">Send Email</h5>
          <button type="button" class="close" (click)="toggleEmail()">&times;</button>
        </div>
  
        <!-- Modal body -->
        <div class="modal-body">
            <ng-container>
                <div class="form-group row">
                    <div class="col-md-6 input-group"  style="padding-left: 2%; padding-right: 2%;" >
                        <div class="input-group-prepend">
                            <div class="input-group-text"><i class="fas fa-at"></i></div>
                          </div>
                        <input type="email" class="form-control" placeholder="Email Address" formControlName="userEmail">
                    </div>
                    <div class="col-md-6 input-group"  style="padding-left: 2%; padding-right: 2%;">
                        <div class="input-group-prepend">
                            <div class="input-group-text"><i class="fas fa-lock"></i></div>
                          </div>
                        <input type="password" class="form-control" placeholder="Password" formControlName="userPassword">
                    </div>
                    
                     
                    
                </div>
                    
                <hr>
                <br>
                <ng-container formArrayName="toEmail">
                    <div *ngFor="let email of toEmail.controls; let i = index" class="form-group row" >
                        <ng-container [formGroupName]="i">
                        <label  class="col-md-1" for=""><ng-container *ngIf="i=== 0">To</ng-container></label>
                        <input type="email" class="form-control form-control-sm col-md-4" placeholder="To" formControlName="email">
                        <button *ngIf="i=== 0" class="btn btn-sm" (click)="newTo()"><i class="fas fa-plus"></i></button>
                        <button *ngIf="i!== 0" class="btn btn-sm"(click)="deleteTo(i)"><i class="fas fa-minus"></i></button></ng-container>
                </div>
                </ng-container>
                <ng-container formArrayName="ccEmail">
                    <div *ngFor="let email of ccEmail.controls; let i = index" class="form-group row" >
                        <ng-container [formGroupName]="i">
                        <label  class="col-md-1" for=""><ng-container *ngIf="i=== 0">Cc</ng-container></label>
                        <input type="email" class="form-control form-control-sm col-md-4" placeholder="Cc" formControlName="email">
                        <button *ngIf="i=== 0" class="btn btn-sm" (click)="newCc()"><i class="fas fa-plus"></i></button>
                        <button *ngIf="i!== 0" class="btn btn-sm"(click)="deleteCc(i)"><i class="fas fa-minus"></i></button></ng-container>
                    </div>
                </ng-container>
                <ng-container  formArrayName="bccEmail">
                    <div *ngFor="let email of bccEmail.controls; let i = index" class="form-group row" >
                        <ng-container [formGroupName]="i">
                        <label  class="col-md-1" for=""><ng-container *ngIf="i=== 0">Bcc</ng-container></label>
                        <input type="email" class="form-control form-control-sm col-md-4" placeholder="Bcc" formControlName="email">
                        <button *ngIf="i=== 0" class="btn btn-sm" (click)="newBcc()"><i class="fas fa-plus"></i></button>
                        <button *ngIf="i!== 0" class="btn btn-sm"(click)="deleteBcc(i)"><i class="fas fa-minus"></i></button></ng-container>
                    </div>
                </ng-container>
                <div class="form-group row">
                    <label class="col-md-1" for="">Subject</label>
                    <input type="text" name="" id="" class="form-control form-control-sm col-md-4" formControlName="subject" placeholder="Subject">
                </div>

                <div *ngIf="emailType==='timesheet'" class="form-group row" style="padding-right: 2%;">
                    <label class="col-md-1" for="">Attachment</label>
                    <a [routerLink]="" class="col-md-3"  (click)="generate()">{{filename}}.xlsx</a>
                </div>

                <div *ngIf="emailType!=='WFH'" class="form-group row" style="padding-right: 2%;">
                    <label class="col-md-1" for="">Body</label>
                    <textarea name="" class="form-control col-md-11"  rows="10" formControlName="message"></textarea>
                </div>
            </ng-container>

            <ng-container *ngIf="emailType === 'WFH'">
                <div class="form-group row">
                    <label class="col-md-1" for="">Body</label>
                    <div class="col-md-8 border border-dark" style="padding: 2%;">
                        
                    
                

        <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Hi Sir!</p>
        <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Please see work from home details for {{ dateArray[group.get('wfh').value] }} ({{days[group.get('wfh').value]| titlecase}}):</p>
        <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Attendance Detail:</p>
        <table border="1" cellspacing="0" cellpadding="0" align="left" style="border-collapse:collapse;border:none;margin-left:6.75pt;margin-right:6.75pt"><tbody><tr style="height:17.1pt"><td width="103" valign="top" style="width:77.3pt;border:1pt solid windowtext;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>LOG IN</b></p></td><td width="103" valign="top" style="width:77.3pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>LOG OUT</b></p></td></tr><tr style="height:17.1pt"><td width="103" valign="top" style="width:77.3pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            {{  
            (group.get('timeInOut')['controls'][group.get('wfh').value].get('timeIn').value!==null)?('2000-01-01T'+group.get('timeInOut')['controls'][group.get('wfh').value].get('timeIn').value | date:'shortTime':'undefined':'en-US'):''}}</p></td><td width="103" valign="top" style="width:77.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt;height:17.1pt"><p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                
            {{ 
            (group.get('timeInOut')['controls'][group.get('wfh').value].get('timeOut').value!==null)?('2000-01-01T'+group.get('timeInOut')['controls'][group.get('wfh').value].get('timeOut').value | date:'shortTime':'undefined':'en-US'):''}}</p></td></tr></tbody></table>
        <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
        <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
        <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
        <p class="MsoNormal" style="margin:0cm 0cm 8pt;line-height:15.6933px;font-size:11pt;font-family:Calibri,sans-serif">Task Accomplishment Summary for the day</p>

        <table border="0" cellspacing="0" cellpadding="0" width="601" style="width:450.8pt;border-collapse:collapse">
            <tbody>
               <tr>
                  <td width="200" valign="top" style="width:150.25pt;border:1pt solid windowtext;padding:0cm 5.4pt">
                     <p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>TASK</b></p>
                  </td>
                  <td width="200" valign="top" style="width:150.25pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0cm 5.4pt">
                     <p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>STATUS</b></p>
                  </td>
                  <td width="200" valign="top" style="width:150.3pt;border-top:1pt solid windowtext;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:none;padding:0cm 5.4pt">
                     <p class="MsoNormal" align="center" style="margin:0cm 0cm 0.0001pt;text-align:center;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>REMARKS</b></p>
                  </td>
               </tr>
               <tr *ngIf="wfhTasks.length === 0">
                <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                    <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">No task for the day</p>
                 </td>
                 <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                 <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
              
                </tr>
               <ng-container *ngFor="let task of wfhArray; let i = index">
                <tr>
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">{{wfhTasks[i]}}</p>
                    </td>
                    <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                    

                        <input class="form-control form-control-sm" list=wfhStatus [(ngModel)]="wfhArray[i]['status']" [ngModelOptions]="{standalone: true}">
                        <datalist id=wfhStatus>
                            <option value="Completed"></option>
                            <option value="Ongoing"></option>
                            
                        </datalist>

                    
                    </td>
                    <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">

                            <input class="form-control form-control-sm" [(ngModel)]="wfhArray[i]['remarks']" [ngModelOptions]="{standalone: true}">


                        
                    </td>
                 </tr>
               </ng-container>
               <tr>
                <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                    &nbsp;
                   </p>
                </td>
                <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
                <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
             </tr>
             <tr>
                <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                    &nbsp;
                   </p>
                </td>
                <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
                <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
             </tr>
                
               
               <tr>
                  <td width="601" colspan="3" valign="top" style="width:450.8pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                     <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif"><b>Other tasks on Queue:</b></p>
                  </td>
               </tr>
               <tr *ngIf="wfhQueue.length === 0">
                <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                    <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">No pending task</p>
                 </td>
                 <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                 <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
              
                </tr>
               <ng-container *ngFor="let task of wfhQueue">
                <tr>
                    <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                       <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">{{task}}</p>
                    </td>
                    <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                    </td>
                    <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt"></td>
                 </tr>
               </ng-container>
               <tr>
                <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                    &nbsp;
                   </p>
                </td>
                <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
                <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
             </tr>
             <tr>
                <td width="200" valign="top" style="width:150.25pt;border-right:1pt solid windowtext;border-bottom:1pt solid windowtext;border-left:1pt solid windowtext;border-top:none;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;
                    &nbsp;
                   </p>
                </td>
                <td width="200" valign="top" style="width:150.25pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
                <td width="200" valign="top" style="width:150.3pt;border-top:none;border-left:none;border-bottom:1pt solid windowtext;border-right:1pt solid windowtext;padding:0cm 5.4pt">
                   <p class="MsoNormal" style="margin:0cm 0cm 0.0001pt;line-height:normal;font-size:11pt;font-family:Calibri,sans-serif">&nbsp;</p>
                </td>
             </tr>
               
               
            </tbody>
         </table>

       
        
    
            
                
                    </div>
                </div>
            </ng-container>
        </div>
  
        <!-- Modal footer -->
        <div class="modal-footer justify-content-between">
            <div>
                <button class="btn btn-primary" (click)="setToWfh()" style="margin: 5px;">WFH</button>
                <button class="btn btn-primary" (click)="setToTimeSheet()" style="margin: 5px;">Timesheet</button>
            </div>

            <button class="btn btn-success" (click)="sendEmail()" style="margin: 5px;">Send</button>

        </div>
  
      </div>
    </div>

</ng-container>




